run:
  timeout: 5m
  tests: true
  modules-download-mode: readonly
  allow-parallel-runners: true
  relative-path-mode: gomod

issues:
  max-issues-per-linter: 0
  max-same-issues: 0
  exclude-rules:
    - path: _test\.go
      linters:
        - forbidigo

linters:
  disable-all: true
  enable:
    - asciicheck
    - bidichk
    - bodyclose
    - contextcheck
    - depguard
    - errcheck
    - errorlint
    - exhaustive
    - forbidigo
    - gosec
    - govet
    - ineffassign
    - misspell
    - noctx
    - revive
    - staticcheck
    - unconvert
    - unused
    - wastedassign
    - wrapcheck

linters-settings:
  depguard:
    rules:
      kernel_must_not_import_driver:
        list-mode: lax
        files:
          - "internal/kernel/**/*.go"
        deny:
          - pkg: ex-otogi/internal/driver
            desc: internal/kernel must not import internal/driver/*
      modules_must_not_import_internal:
        list-mode: lax
        files:
          - "modules/**/*.go"
        deny:
          - pkg: ex-otogi/internal
            desc: modules/* must not import internal/*
      pkg_llm_must_not_import_internal:
        list-mode: lax
        files:
          - "pkg/llm/**/*.go"
        deny:
          - pkg: ex-otogi/internal
            desc: pkg/llm must not import internal/*
      pkg_otogi_must_not_import_internal:
        list-mode: lax
        files:
          - "pkg/otogi/**/*.go"
        deny:
          - pkg: ex-otogi/internal
            desc: pkg/otogi must not import internal/*

  errcheck:
    check-type-assertions: true
    check-blank: true

  exhaustive:
    default-signifies-exhaustive: true

  forbidigo:
    forbid:
      - "^fmt\\.Print(f|ln)?$"
      - "^panic$"
      - "^print$"
      - "^println$"

  govet:
    enable:
      - appends
      - asmdecl
      - assign
      - atomic
      - bools
      - buildtag
      - cgocall
      - composites
      - copylocks
      - httpresponse
      - ifaceassert
      - loopclosure
      - lostcancel
      - nilfunc
      - nilness
      - printf
      - shift
      - sigchanyzer
      - stdmethods
      - stringintconv
      - structtag
      - tests
      - unmarshal
      - unreachable
      - unsafeptr
      - unusedresult

  misspell:
    locale: US

  revive:
    confidence: 0.8
    severity: warning
    rules:
      - name: blank-imports
      - name: context-as-argument
      - name: context-keys-type
      - name: defer
      - name: early-return
      - name: empty-lines
      - name: errorf
      - name: error-return
      - name: error-strings
      - name: exported
      - name: if-return
      - name: increment-decrement
      - name: range
      - name: receiver-naming
      - name: redefines-builtin-id
      - name: superfluous-else
      - name: time-naming
      - name: unexported-return
      - name: unnecessary-stmt
      - name: unreachable-code
      - name: unused-parameter

  staticcheck:
    checks:
      - all

  wrapcheck:
    ignore-package-globs:
      - errors
      - fmt

output:
  sort-results: true
